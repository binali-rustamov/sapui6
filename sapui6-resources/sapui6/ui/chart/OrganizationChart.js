jQuery.sap.declare("sapui6.ui.chart.OrganizationChart"),jQuery.sap.require("sap.ui.core.Control"),sap.ui.core.Control.extend("sapui6.ui.chart.OrganizationChart",{library:"sapui6.ui.chart",metadata:{properties:{visible:{type:"boolean",defaultValue:!0},width:{type:"sap.ui.core.CSSSize",defaultValue:null},height:{type:"sap.ui.core.CSSSize",defaultValue:null},fontSize:{type:"string",defaultValue:"12px"},textColor:{type:"string",defaultValue:"#fff"},boxColor:{type:"string",defaultValue:"#990066"},boxBorderColor:{type:"string",defaultValue:"#fff"},boxWidth:{type:"string",defaultValue:"140px"},boxHeight:{type:"string",defaultValue:"40px"},boxBorderWidth:{type:"string",defaultValue:"0"},boxVInterval:{type:"string",defaultValue:"50px"},lineColor:{type:"string",defaultValue:"#000"},imageWidth:{type:"string",defaultValue:"30px"},imageHeight:{type:"string",defaultValue:"50px"},backgroundColor:{type:"string",defaultValue:"#fff"},animation:{type:"boolean",defaultValue:!1}},defaultAggregation:"items",aggregations:{items:{type:"sapui6.ui.chart.OrganizationChartItem",multiple:!0,singularName:"item",bindable:"bindable"}},events:{select:{}}},_level:0,renderer:function(t,e){e.getVisible()&&(t.write("<div"),t.writeControlData(e),t.addStyle("width",e.getWidth()),t.addStyle("height",e.getHeight()),t.addStyle("backgroundColor",e.getBackgroundColor()),t.writeStyles(),t.write(">"),t.write("</div>"))},onAfterRendering:function(){if(0!=this.getItems().length){var t=$("#"+this.getId()).width(),e=$("#"+this.getId()).height(),i=parseFloat(this.getBoxWidth().split("px")[0]),l=parseFloat(this.getBoxHeight().split("px")[0]),r=[];r.push('<svg width="'+t+'" height="'+e+'"'),r.push(' style="background-color:'+this.getBackgroundColor()+';"'),r.push(">");var a=1;this.getAnimation()&&(a=.1),r.push('<g id="'+this.getId()+'-svg-group" transform="scale('+a+')">');var o=this.getRoot(),s=t/2-i/2,g=o.getBoxColor()?o.getBoxColor():this.getBoxColor(),n=o.getTextColor()?o.getTextColor():this.getTextColor(),h=o.getFontSize()?o.getFontSize():this.getFontSize(),u=parseFloat(h.split("px")[0])+5,p=parseFloat(this.getImageWidth().split("px")[0]),d=parseFloat(this.getImageHeight().split("px")[0]),x=(l-d)/2;r.push('<g id="'+this.getId()+"-group-"+o.getIdx()+'" data-sapui6-orgchart-idx="'+o.getIdx()+'">'),r.push('<rect x="'+s+'" y="20" width="'+i+'px" height="'+l+'px" style="fill:'+g+";stroke:"+this.getLineColor()+";stroke-width:"+this.getBoxBorderWidth()+';"></rect>'),o.getSrc()?(r.push('<image x="'+(s+10)+'" y="'+(20+x)+'" width="'+this.getImageWidth()+'" height="'+this.getImageHeight()+'" xlink:href="'+o.getSrc()+'" />'),o.getTitle()&&o.getSubTitle()?(r.push('<text x="'+(s+10+p+10)+'" y="'+(20+.4*l)+'" style="text-anchor: start;fill:'+n+";font-size:"+h+';font-weight:bold;">'+o.getTitle()+"</text>"),r.push('<text x="'+(s+10+p+10)+'" y="'+(20+.4*l+u)+'" style="text-anchor: start;fill:'+n+";font-size:"+h+';font-weight:bold;">'+o.getSubTitle()+"</text>")):o.getTitle()&&r.push('<text x="'+(s+10+p+10)+'" y="'+(20+.5*l)+'" style="text-anchor: start;fill:'+n+";font-size:"+h+';font-weight:bold;">'+o.getTitle()+"</text>")):o.getTitle()&&o.getSubTitle()?(r.push('<text x="'+t/2+'" y="'+(20+.4*l)+'" style="text-anchor: middle;fill:'+n+";font-size:"+h+';font-weight:bold;">'+o.getTitle()+"</text>"),r.push('<text x="'+t/2+'" y="'+(20+.4*l+u)+'" style="text-anchor: middle;fill:'+n+";font-size:"+h+';font-weight:bold;">'+o.getSubTitle()+"</text>")):o.getTitle()&&r.push('<text x="'+t/2+'" y="'+(20+.5*l)+'" style="text-anchor: middle;fill:'+n+";font-size:"+h+';font-weight:bold;">'+o.getTitle()+"</text>"),r.push("</g>");var f=t/2,y=20+l;if(r.push(this.renderChild(o.getKey(),t,0,f,y)),r.push("</g>"),r.push("</svg>"),$("#"+this.getId()).html(r.join("")),this.getAnimation())var c=this,m=1,C=window.setInterval(function(){m>10?window.clearInterval(C):($("#"+c.getId()+"-svg-group").attr("transform","scale("+.1*m+")"),m++)},70);var c=this;window.setTimeout(function(){for(var t=c.getItems().length,e=0;t>e;e++)document.getElementById(c.getId()+"-group-"+e).onclick=sap.ui.getCore().byId(c.getId()).mouseclick.bind(c)},1e3)}}}),sapui6.ui.chart.OrganizationChart.M_EVENTS={select:"select"},sapui6.ui.chart.OrganizationChart.prototype.renderChild=function(t,e,i,l,r){for(var a=this.getChild(t),o=a.length,s=Math.floor(e/o),g=parseFloat(this.getBoxWidth().split("px")[0]),n=parseFloat(this.getBoxHeight().split("px")[0]),h=parseFloat(this.getBoxVInterval().split("px")[0]),u=[],p=0;o>p;p++){var d=i+s/2+s*p-g/2,x=this.getLevel(a[p].getKey());this._level=0;var f=a[p].getBoxColor()?a[p].getBoxColor():this.getBoxColor(),y=a[p].getTextColor()?a[p].getTextColor():this.getTextColor(),c=a[p].getFontSize()?a[p].getFontSize():this.getFontSize(),m=parseFloat(c.split("px")[0])+5,C=parseFloat(this.getImageWidth().split("px")[0]),b=parseFloat(this.getImageHeight().split("px")[0]),I=(s-g)/2+10,v=(n-b)/2;u.push('<g id="'+this.getId()+"-group-"+a[p].getIdx()+'"  data-sapui6-orgchart-idx="'+a[p].getIdx()+'">'),u.push('<rect x="'+d+'" y="'+(20+(n+h)*(x-1))+'" width="'+g+'px" height="'+n+'px" style="fill:'+f+";stroke:"+this.getLineColor()+";stroke-width:"+this.getBoxBorderWidth()+';"></rect>'),a[p].getSrc()?(u.push('<image x="'+(i+I+s*p)+'" y="'+(20+(n+h)*(x-1)+v)+'" width="'+this.getImageWidth()+'" height="'+this.getImageHeight()+'" xlink:href="'+a[p].getSrc()+'" />'),a[p].getTitle()&&a[p].getSubTitle()?(u.push('<text x="'+(i+(I+10+C)+s*p)+'" y="'+(20+(n+h)*(x-1)+.4*n)+'" style="text-anchor: start;fill:'+y+";font-size:"+c+';font-weight:bold;">'+a[p].getTitle()+"</text>"),u.push('<text x="'+(i+(I+10+C)+s*p)+'" y="'+(20+(n+h)*(x-1)+.4*n+m)+'" style="text-anchor: start;fill:'+y+";font-size:"+c+';font-weight:bold;">'+a[p].getSubTitle()+"</text>")):a[p].getTitle()&&u.push('<text x="'+(i+(I+10+C)+s*p)+'" y="'+(20+(n+h)*(x-1)+.5*n)+'" style="text-anchor: start;fill:'+y+";font-size:"+c+';font-weight:bold;">'+a[p].getTitle()+"</text>")):a[p].getTitle()&&a[p].getSubTitle()?(u.push('<text x="'+(i+s/2+s*p)+'" y="'+(20+(n+h)*(x-1)+.4*n)+'" style="text-anchor: middle;fill:'+y+";font-size:"+c+';font-weight:bold;">'+a[p].getTitle()+"</text>"),u.push('<text x="'+(i+s/2+s*p)+'" y="'+(20+(n+h)*(x-1)+.4*n+m)+'" style="text-anchor: middle;fill:'+y+";font-size:"+c+';font-weight:bold;">'+a[p].getSubTitle()+"</text>")):a[p].getTitle()&&u.push('<text x="'+(i+s/2+s*p)+'" y="'+(20+(n+h)*(x-1)+.5*n)+'" style="text-anchor: middle;fill:'+y+";font-size:"+c+';font-weight:bold;">'+a[p].getTitle()+"</text>"),u.push("</g>"),u.push('<polyline points="'+l+","+r+" "+l+","+(20+(n+h)*(x-1)-25)+" "+(i+s/2+s*p)+","+(20+(n+h)*(x-1)-25)+" "+(i+s/2+s*p)+","+(20+(n+h)*(x-1))+'" style="fill:transparent;stroke:'+this.getLineColor()+';" />');var w=i+s/2+s*p,z=20+(n+h)*(x-1)+n;u.push(this.renderChild(a[p].getKey(),s,i+s*p,w,z))}return u.join("")},sapui6.ui.chart.OrganizationChart.prototype.getRoot=function(){for(var t=null,e=this.getItems().length,i=0;e>i;i++){var l=this.getItems()[i];if(null==l.getParentKey()||""==l.getParentKey()){l.setProperty("idx",i,!0),t=l;break}}return t},sapui6.ui.chart.OrganizationChart.prototype.getChild=function(t){for(var e=[],i=this.getItems().length,l=0;i>l;l++){var r=this.getItems()[l];r.getParentKey()&&r.getParentKey()==t&&(r.setProperty("idx",l,!0),e.push(r))}return e},sapui6.ui.chart.OrganizationChart.prototype.getLevel=function(t){for(var e=this.getItems().length,i=0;e>i;i++){var l=this.getItems()[i];l.getKey()&&l.getKey()==t&&(this._level++,this.getLevel(l.getParentKey()))}return this._level},sapui6.ui.chart.OrganizationChart.prototype.mouseclick=function(t){for(var e=t.target?t.target:t.srcElement,i=e;"g"!=i.tagName.toLowerCase();)i=i.parentNode;var l=parseInt(i.getAttribute("data-sapui6-orgchart-idx"));this.fireSelect({dataIndex:l,key:this.getItems()[l].getKey(),parentKey:this.getItems()[l].getParentKey(),obj:i})},jQuery.sap.declare("sapui6.ui.chart.OrganizationChartItem"),jQuery.sap.require("sap.ui.core.Element"),sap.ui.core.Element.extend("sapui6.ui.chart.OrganizationChartItem",{metadata:{library:"sapui6.ui.chart",properties:{key:{type:"string",defaultValue:null},title:{type:"string",defaultValue:null},subTitle:{type:"string",defaultValue:null},parentKey:{type:"string",defaultValue:null},textColor:{type:"string",defaultValue:null},fontSize:{type:"string",defaultValue:null},boxColor:{type:"string",defaultValue:null},boxBorderColor:{type:"string",defaultValue:null},src:{type:"string",defaultValue:null},idx:{type:"int",defaultValue:-1}}}});
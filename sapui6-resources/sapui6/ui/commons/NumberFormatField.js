jQuery.sap.declare("sapui6.ui.commons.NumberFormatField"),sap.ui.commons.TextField.extend("sapui6.ui.commons.NumberFormatField",{library:"sapui6.ui.commons",metadata:{properties:{format:{type:"string",defaultValue:null},before:{type:"string",defaultValue:null},after:{type:"string",defaultValue:null},"float":{type:"boolean",defaultValue:!1}}},renderer:{},onAfterRendering:function(){this.getBefore()&&$(this.getInputDomRef()).before('<span style="vertical-align:sub;">'+this.getBefore()+"</span>"),this.getAfter()&&$(this.getInputDomRef()).after('<span style="vertical-align:sub;">'+this.getAfter()+"</span>"),this.getFloat()?this.attachBrowserEvent("keydown",function(e){var t=window.event?event.keyCode:e.which,n=window.event?event.ctrlKey:e.ctrlKey,i=window.event?event.shiftKey:e.shiftKey;if(i)window.event?event.preventDefault?event.preventDefault():event.returnValue=!1:e.preventDefault();else{if(t>=48&&57>=t||t>=96&&105>=t||9==t||8==t||13==t||37==t||39==t||46==t||110==t||190==t||109==t||189==t)return!0;if(n&&86==t)return!0;if(n&&67==t)return!0;window.event?event.preventDefault?event.preventDefault():event.returnValue=!1:e.preventDefault()}}):this.attachBrowserEvent("keydown",function(e){var t=window.event?event.keyCode:e.which,n=window.event?event.ctrlKey:e.ctrlKey,i=window.event?event.shiftKey:e.shiftKey;if(i)window.event?event.preventDefault?event.preventDefault():event.returnValue=!1:e.preventDefault();else{if(t>=48&&57>=t||t>=96&&105>=t||9==t||8==t||13==t||37==t||39==t||46==t||109==t||189==t)return!0;if(n&&86==t)return!0;if(n&&67==t)return!0;window.event?event.preventDefault?event.preventDefault():event.returnValue=!1:e.preventDefault()}});var e=this;this.attachBrowserEvent("focus",function(){var t=e.getBindingInfo("value");t&&(e.getInputDomRef().value=t.binding.oValue)}),this.attachBrowserEvent("blur",function(){e.getBindingInfo("value")&&e.setValue(e.getDomRef().value)})}}),sapui6.ui.commons.NumberFormatField.prototype.bindValue=function(e){this.bindProperty("value",{path:e,type:this.getType()})},sapui6.ui.commons.NumberFormatField.prototype.getParseValue=function(){return this.getBindingInfo("value").binding.oValue},sapui6.ui.commons.NumberFormatField.prototype.getType=function(){var e=!1,t=",",n=".",i=0,r=0,a=0,u=0,o=this.getFormat();if(o.indexOf(",")>-1)if(e=!0,o.indexOf(".")>-1)if(o.indexOf(",")<o.indexOf(".")){t=",",n=".";var l=o.split(".")[0],s=o.split(".")[1];i=this._countChar(l,"0"),r=l.length,a=this._countChar(s,"0"),u=s.length}else{t=".",n=",";var l=o.split(",")[0],s=o.split(",")[1];i=this._countChar(l,"0"),r=l.length,a=this._countChar(s,"0"),u=s.length}else t=",",i=this._countChar(o,"0"),r=o.length;else if(o.indexOf(".")>-1){e=!1;var l=o.split(".")[0],s=o.split(".")[1];i=this._countChar(l,"0"),r=l.length,a=this._countChar(s,"0"),u=s.length}else e=!1,i=this._countChar(o,"0"),r=o.length;u>0&&this.setFloat(!0);var f=new sap.ui.model.type.Float({minIntegerDigits:i,minFractionDigits:a,maxFractionDigits:u,groupingEnabled:e,groupingSeparator:t,decimalSeparator:n});return f},sapui6.ui.commons.NumberFormatField.prototype._countChar=function(e,t){for(var n=0,i=e.length,r=0;i>r;r++)e.charAt(r)==t&&n++;return n};